[StringList.cpp]
Source00000=// ===========================================================
Source00001=//		StringListクラス
Source00002=//
Source00003=//				2003.02.12 Ver.1.0 
Source00004=// ===========================================================
Source00005=
Source00006=
Source00007=// ===========================================
Source00008=//		インクルード・ファイ
Source00009=// ===========================================
Source00010=#include <io.h>
Source00011=#include "stdafx.h"
Source00012=#include "StringList.h"
Source00013=
Source00014=
Source00015=// ===========================================
Source00016=//		マクロ定義
Source00017=// ===========================================
Source00018=
Source00019=
Source00020=// ===========================================
Source00021=//		数値定義
Source00022=// ===========================================
Source00023=
Source00024=
Source00025=// ===========================================
Source00026=//		構
Source00027=// ===========================================
Source00028=
Source00029=
Source00030=// ===========================================
Source00031=//		クラス
Source00032=// ===========================================
Source00033=
Source00034=
Source00035=// ===========================================
Source00036=//		変数定義
Source00037=// ===========================================
Source00038=
Source00039=
Source00040=// ===========================================
Source00041=//		関数定義
Source00042=// ===========================================
Source00043=
Source00044=
Source00045=/*=============================================================================
Source00046=*NAME		:TStringList::Assign
Source00047=			:
Source00048=*MODULE		:StringList.cpp
Source00049=			:
Source00050=*FUNCTION	:内容コピー
Source00051=			:
Source00052=*PROCESS	:・内容コピー処理です。
Source00053=			:
Source00054=*INPUT		:const TStringList source	:コピーもとクラス
Source00055=			:
Source00056=*PROGRAMMED	:Y.Sasai
Source00057=*HISTORY	:
Source00058=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00059=*00 03.02.10 Y.Sasai Ver.0.90 
Source00060=*/
Source00061=void TStringList::Assign( TStringList* source )
Source00062={
Source00063=	int tempi;
Source00064=
Source00065=	Clear();																					// 2003.02.10 Y.Sasai Ver.0.90 全
Source00066=	for ( tempi = 0; tempi < source->Count; tempi++ ) {
Source00067=		Add( source->Items[tempi] );															// 2003.02.10 Y.Sasai Ver.0.90 
Source00068=	}
Source00069=}
Source00070=
Source00071=
Source00072=/*=============================================================================
Source00073=*NAME		:TStringList::KeyExists
Source00074=			:
Source00075=*MODULE		:StringList.cpp
Source00076=			:
Source00077=*FUNCTION	:キー名存在チェック
Source00078=			:
Source00079=*PROCESS	:・キー名存在チェック処理です。
Source00080=			:
Source00081=*INPUT		:const CString key	:キー
Source00082=			:
Source00083=*RETURN		: true = 正常終
Source00084=			:false = エラー終
Source00085=			:
Source00086=*PROGRAMMED	:Y.Sasai
Source00087=*HISTORY	:
Source00088=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00089=*00 03.02.10 Y.Sasai Ver.0.90 
Source00090=*/
Source00091=bool TStringList::KeyExists( const CString key )
Source00092={
Source00093=	return ( IdentExists( key ) );																// 2003.02.10 Y.Sasai Ver.0.90 なかみはIdentExists
Source00094=}
Source00095=
Source00096=
Source00097=/*=============================================================================
Source00098=*NAME		:TStringList::IdentExists
Source00099=			:
Source00100=*MODULE		:StringList.cpp
Source00101=			:
Source00102=*FUNCTION	:Ident名存在チェック
Source00103=			:
Source00104=*PROCESS	:・Ident名存在チェック処理です。
Source00105=			:
Source00106=*INPUT		:const CString iname
Source00107=			:
Source00108=*RETURN		: true = 
Source00109=			:false = 
Source00110=			:
Source00111=*PROGRAMMED	:Y.Sasai
Source00112=*HISTORY	:
Source00113=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00114=*00 03.02.10 Y.Sasai Ver.0.90 
Source00115=*/
Source00116=bool TStringList::IdentExists( const CString iname )
Source00117={
Source00118=	return ( IdentIndex( iname ) >= 0 );														// 2003.02.10 Y.Sasai Ver.0.90 あればtrue
Source00119=}
Source00120=
Source00121=
Source00122=/*=============================================================================
Source00123=*NAME		:TStringList::IdentIndex
Source00124=			:
Source00125=*MODULE		:StringList.cpp
Source00126=			:
Source00127=*FUNCTION	:Ident位置
Source00128=			:
Source00129=*PROCESS	:・Ident位置取得処理です。
Source00130=			:
Source00131=*INPUT		:const CString iname	:ident
Source00132=			:
Source00133=*RETURN		:位置
Source00134=			:-1 = 
Source00135=			:
Source00136=*PROGRAMMED	:Y.Sasai
Source00137=*HISTORY	:
Source00138=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00139=*00 03.02.10 Y.Sasai Ver.0.90 
Source00140=*/
Source00141=int TStringList::IdentIndex( const CString iname )
Source00142={
Source00143=	int tempi;
Source00144=
Source00145=	for ( tempi = 0; tempi < Count; tempi++ ) {
Source00146=		if ( iname.CompareNoCase( Ident[tempi] ) == 0 ) {										// 2003.02.10 Y.Sasai Ver.0.90 同じなら…
Source00147=			return ( tempi );																	// 2003.02.10 Y.Sasai Ver.0.90 
Source00148=		}
Source00149=	}
Source00150=
Source00151=	return ( -1 );																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00152=}
Source00153=
Source00154=
Source00155=/*=============================================================================
Source00156=*NAME		:TStringList::DeleteValue
Source00157=			:
Source00158=*MODULE		:StringList.cpp
Source00159=			:
Source00160=*FUNCTION   :値
Source00161=            :
Source00162=*PROCESS    :・値削除処理です。
Source00163=			:
Source00164=*INPUT		:const CString iname	:Ident
Source00165=			:
Source00166=*PROGRAMMED	:Y.Sasai
Source00167=*HISTORY	:
Source00168=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00169=*00 03.02.10 Y.Sasai Ver.0.90 
Source00170=*/
Source00171=void TStringList::DeleteValue( const CString iname )
Source00172={
Source00173=	const int ipos = IdentIndex( iname );														// 2003.02.10 Y.Sasai Ver.0.90 Ident名位置
Source00174=
Source00175=	if ( ipos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00176=		return;																					// 2003.02.10 Y.Sasai Ver.0.90 
Source00177=	}
Source00178=	Delete( ipos );																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00179=}
Source00180=
Source00181=
Source00182=/*=============================================================================
Source00183=*NAME		:TStringList::Add
Source00184=			:
Source00185=*MODULE		:StringList.cpp
Source00186=			:
Source00187=*FUNCTION	:アイテムズ
Source00188=			:
Source00189=*PROCESS	:・アイテムズ追加処理です。
Source00190=			:
Source00191=*INPUT		:const CString txt	:
Source00192=			:
Source00193=*RETURN		:追加した要素位置
Source00194=			:
Source00195=*PROGRAMMED	:Y.Sasai
Source00196=*HISTORY	:
Source00197=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00198=*00 03.02.10 Y.Sasai Ver.0.90 
Source00199=*/
Source00200=int TStringList::Add( const CString txt )
Source00201={
Source00202=	AddTail( txt );																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00203=	return ( Count );
Source00204=}
Source00205=
Source00206=
Source00207=/*=============================================================================
Source00208=*NAME		:TStringList::Delete
Source00209=			:
Source00210=*MODULE		:StringList.cpp
Source00211=			:
Source00212=*FUNCTION	:
Source00213=			:
Source00214=*PROCESS	:・指定位置の文字列を削除します。
Source00215=			:
Source00216=*INPUT		:const int index	:インデックス
Source00217=			:
Source00218=*PROGRAMMED	:Y.Sasai
Source00219=*HISTORY	:
Source00220=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00221=*00 03.02.10 Y.Sasai Ver.0.90 
Source00222=*/
Source00223=void TStringList::Delete( const int index )
Source00224={
Source00225=	RemoveAt( FindIndex( index ) );																// 2003.02.10 Y.Sasai Ver.0.90 
Source00226=}
Source00227=
Source00228=
Source00229=/*=============================================================================
Source00230=*NAME		:TStringList::Clear
Source00231=			:
Source00232=*MODULE		:StringList.cpp
Source00233=			:
Source00234=*FUNCTION	:全データ
Source00235=			:
Source00236=*PROCESS	:・全データ削除します。
Source00237=			:
Source00238=*PROGRAMMED	:Y.Sasai
Source00239=*HISTORY	:
Source00240=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00241=*00 03.02.10 Y.Sasai Ver.0.90 
Source00242=*/
Source00243=void TStringList::Clear( void )
Source00244={
Source00245=	RemoveAll();																				// 2003.02.10 Y.Sasai Ver.0.90 全データ
Source00246=}
Source00247=
Source00248=
Source00249=/*=============================================================================
Source00250=*NAME		:TStringList::LoadFromFile
Source00251=			:
Source00252=*MODULE		:StringList.cpp
Source00253=			:
Source00254=*FUNCTION	:ファイ
Source00255=			:
Source00256=*PROCESS	:・ファイルから読み込み処理です。
Source00257=			:
Source00258=*INPUT		:const CString fname	:ファイ
Source00259=			:
Source00260=*RETURN		: true = 正常終
Source00261=			:false = エラー終
Source00262=			:
Source00263=*PROGRAMMED	:Y.Sasai
Source00264=*HISTORY	:
Source00265=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00266=*00 03.02.10 Y.Sasai Ver.0.90 
Source00267=*/
Source00268=bool TStringList::LoadFromFile( const CString fname )
Source00269={
Source00270=	FILE* fp = fopen( fname, "rt" );															// 2003.02.10 Y.Sasai Ver.0.90 テキスト読み込みモード
Source00271=	char txt[1024+1];
Source00272=	bool result = true;
Source00273=	int tempi;
Source00274=
Source00275=	if ( fp == NULL ) {																			// 2003.02.10 Y.Sasai Ver.0.90 NULLなら…
Source00276=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00277=	}
Source00278=	Clear();																					// 2003.02.12 Y.Sasai Ver.0.90 全
Source00279=	while ( true ) {
Source00280=		if ( fgets( txt,  sizeof( txt ) - 1, fp ) == NULL ) {									// 2003.02.10 Y.Sasai Ver.0.90 １行読み込みおわりなら…
Source00281=			if ( feof( fp ) == 0 ) {															// 2003.02.10 Y.Sasai Ver.0.90 終端でないなら…
Source00282=				result = false;																	// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00283=			}
Source00284=			break;																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00285=		}
Source00286=		for ( tempi = strlen( txt ) - 1; tempi >= 0; tempi-- ) {
Source00287=			if ( txt[tempi] < ' ' ) {															// 2003.02.12 Y.Sasai Ver.0.90 制御文字なら…
Source00288=				txt[tempi] = 0;																	// 2003.02.12 Y.Sasai Ver.0.90 ヌ
Source00289=			} else {																			// 2003.02.13 Y.Sasai Ver.0.90 通常文字なら…
Source00290=				break;
Source00291=			}
Source00292=		}
Source00293=		Add( txt );																				// 2003.02.12 Y.Sasai Ver.0.90 
Source00294=	}
Source00295=	if ( fclose( fp ) != 0 ) {																	// 2003.02.10 Y.Sasai Ver.0.90 クローズエラーなら…
Source00296=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00297=	}
Source00298=
Source00299=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00300=}
Source00301=
Source00302=
Source00303=/*=============================================================================
Source00304=*NAME		:TStringList::SaveToFile
Source00305=			:
Source00306=*MODULE		:StringList.cpp
Source00307=			:
Source00308=*FUNCTION	:ファイ
Source00309=			:
Source00310=*PROCESS	:・ファイルに書き込み処理です。
Source00311=			:
Source00312=*INPUT		:const CString fname	:ファイ
Source00313=			:
Source00314=*RETURN		: true = 正常終
Source00315=			:false = エラー終
Source00316=			:
Source00317=*PROGRAMMED	:Y.Sasai
Source00318=*HISTORY	:
Source00319=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00320=*00 03.02.10 Y.Sasai Ver.0.90 
Source00321=*/
Source00322=bool TStringList::SaveToFile( const CString fname )
Source00323={
Source00324=	FILE* fp = fopen( fname, "wt" );															// 2003.02.10 Y.Sasai Ver.0.90 テキスト書き込みモード
Source00325=	int tempi;
Source00326=	bool result = true;
Source00327=	CString txt;
Source00328=
Source00329=	if ( fp == NULL ) {																			// 2003.02.10 Y.Sasai Ver.0.90 オープンできなかったら…
Source00330=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00331=	}
Source00332=	for ( tempi = 0; tempi < Count; tempi++ ) {
Source00333=		txt = Items[tempi] + "\n";																// 2003.02.12 Y.Sasai Ver.0.90 改行コード
Source00334=		if ( fputs( txt, fp ) < 0 ) {															// 2003.02.10 Y.Sasai Ver.0.90 １行書き込みエラーなら…
Source00335=			result = false;																		// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00336=			break;																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00337=		}
Source00338=	}
Source00339=	if ( fclose( fp ) != 0 ) {																	// 2003.02.10 Y.Sasai Ver.0.90 クローズエラーなら…
Source00340=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00341=	}
Source00342=
Source00343=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00344=}
Source00345=
Source00346=
Source00347=/*=============================================================================
Source00348=*NAME		:TYSIniSection::ItemsGet
Source00349=			:
Source00350=*MODULE		:StringList.cpp
Source00351=			:
Source00352=*FUNCTION	:アイテムズ
Source00353=			:
Source00354=*PROGRAMMED	:Y.Sasai
Source00355=*HISTORY	:
Source00356=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00357=*00 03.02.10 Y.Sasai Ver.0.90 
Source00358=*/
Source00359=CString TStringList::ItemsGet( const int a1 )
Source00360={
Source00361=	return ( GetAt( FindIndex( a1 ) ) );
Source00362=}
Source00363=
Source00364=
Source00365=/*=============================================================================
Source00366=*NAME		:TStringList::ItemsSet
Source00367=			:
Source00368=*MODULE		:StringList.cpp
Source00369=			:
Source00370=*FUNCTION	:アイテムズ
Source00371=			:
Source00372=*PROGRAMMED	:Y.Sasai
Source00373=*HISTORY	:
Source00374=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00375=*00 03.02.10 Y.Sasai Ver.0.90 
Source00376=*/
Source00377=void TStringList::ItemsSet( const int a1, const CString p1 )
Source00378={
Source00379=	SetAt( FindIndex( a1 ), p1 );
Source00380=}
Source00381=
Source00382=
Source00383=/*=============================================================================
Source00384=*NAME		:TStringList::IdentGet
Source00385=			:
Source00386=*MODULE		:StringList.cpp
Source00387=			:
Source00388=*FUNCTION	:Ident
Source00389=			:
Source00390=*PROGRAMMED	:Y.Sasai
Source00391=*HISTORY	:
Source00392=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00393=*00 03.02.10 Y.Sasai Ver.0.90 
Source00394=*/
Source00395=CString TStringList::IdentGet( const int a1 )
Source00396={
Source00397=	return ( BeforeEqual( Items[a1] ) );
Source00398=}
Source00399=
Source00400=
Source00401=/*=============================================================================
Source00402=*NAME		:TStringList::IdentSet
Source00403=			:
Source00404=*MODULE		:StringList.cpp
Source00405=			:
Source00406=*FUNCTION	:Ident
Source00407=			:
Source00408=*PROGRAMMED	:Y.Sasai
Source00409=*HISTORY	:
Source00410=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00411=*00 03.02.10 Y.Sasai Ver.0.90 
Source00412=*/
Source00413=void TStringList::IdentSet( const int a1, const CString p1 )
Source00414={
Source00415=	CString vtxt = AfterEqual( Items[a1] );														// 2003.02.10 Y.Sasai Ver.0.90 Value
Source00416=	Items[a1] = p1 + "=" + vtxt;																// 2003.02.10 Y.Sasai Ver.0.90 新
Source00417=}
Source00418=
Source00419=
Source00420=/*=============================================================================
Source00421=*NAME		:TStringList::ValueGet
Source00422=			:
Source00423=*MODULE		:StringList.cpp
Source00424=			:
Source00425=*FUNCTION	:値
Source00426=			:
Source00427=*PROGRAMMED	:Y.Sasai
Source00428=*HISTORY	:
Source00429=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00430=*00 03.02.10 Y.Sasai Ver.0.90 
Source00431=*/
Source00432=CString TStringList::ValueGet( const CString a1 )
Source00433={
Source00434=	const int ipos = IdentIndex( a1 );															// 2003.02.10 Y.Sasai Ver.0.90 Index
Source00435=
Source00436=	if ( ipos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00437=		return ( "" );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00438=	}
Source00439=
Source00440=	return ( AfterEqual( Items[ipos] ) );														// 2003.02.10 Y.Sasai Ver.0.90 Value
Source00441=}
Source00442=
Source00443=
Source00444=/*=============================================================================
Source00445=*NAME		:TStringList::ValueSet
Source00446=			:
Source00447=*MODULE		:StringList.cpp
Source00448=			:
Source00449=*FUNCTION	:値
Source00450=			:
Source00451=*PROGRAMMED	:Y.Sasai
Source00452=*HISTORY	:
Source00453=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00454=*00 03.02.10 Y.Sasai Ver.0.90 
Source00455=*/
Source00456=void TStringList::ValueSet( const CString a1, const CString p1 )
Source00457={
Source00458=	const int ipos = IdentIndex( a1 );															// 2003.02.10 Y.Sasai Ver.0.90 Index
Source00459=
Source00460=	if ( ipos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00461=		Add( a1 + "=" + p1 );																	// 2003.02.10 Y.Sasai Ver.0.90 
Source00462=	} else {																					// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00463=		Items[ipos] = Ident[ipos] + "=" + p1;													// 2003.02.10 Y.Sasai Ver.0.90 
Source00464=	}
Source00465=}
Source00466=
Source00467=
Source00468=/*=============================================================================
Source00469=*NAME		:TStringList::CountGet
Source00470=			:
Source00471=*MODULE		:StringList.cpp
Source00472=			:
Source00473=*FUNCTION	:要素
Source00474=			:
Source00475=*PROGRAMMED	:Y.Sasai
Source00476=*HISTORY	:
Source00477=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00478=*00 03.02.10 Y.Sasai Ver.0.90 
Source00479=*/
Source00480=int TStringList::CountGet( void )
Source00481={
Source00482=	return ( GetCount() );
Source00483=}
Source00484=
Source00485=
Source00486=/*=============================================================================
Source00487=*NAME		:TStringList::BeforeEqual
Source00488=			:
Source00489=*MODULE		:StringList.cpp
Source00490=			:
Source00491=*FUNCTION	:イコール文字より前
Source00492=			:
Source00493=*PROGRAMMED	:Y.Sasai
Source00494=*HISTORY	:
Source00495=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00496=*00 03.02.10 Y.Sasai Ver.0.90 
Source00497=*/
Source00498=CString TStringList::BeforeEqual( const CString txt )
Source00499={
Source00500=	const int epos = txt.Find( '=' );															// 2003.02.10 Y.Sasai Ver.0.90 イコー
Source00501=	CString result;
Source00502=
Source00503=	if ( epos >= 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00504=		result = txt.Left( epos );																// 2003.02.10 Y.Sasai Ver.0.90 前
Source00505=	} else {																					// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00506=		result = txt;																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00507=	}
Source00508=
Source00509=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00510=}
Source00511=
Source00512=
Source00513=/*=============================================================================
Source00514=*NAME		:TStringList::AfterEqual
Source00515=			:
Source00516=*MODULE		:StringList.cpp
Source00517=			:
Source00518=*FUNCTION	:イコー
Source00519=			:
Source00520=*PROGRAMMED	:Y.Sasai
Source00521=*HISTORY	:
Source00522=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00523=*00 03.02.10 Y.Sasai Ver.0.90 
Source00524=*/
Source00525=CString TStringList::AfterEqual( const CString txt )
Source00526={
Source00527=	const int epos = txt.Find( '=' );															// 2003.02.10 Y.Sasai Ver.0.90 イコー
Source00528=	CString result;
Source00529=
Source00530=	if ( epos >= 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00531=		result = txt.Mid( epos + 1 );															// 2003.02.10 Y.Sasai Ver.0.90 
Source00532=	} else {																					// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00533=		result = "";																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00534=	}
Source00535=
Source00536=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00537=}
Source00538=
Source00539=
Source00540=/*=============================================================================
Source00541=*NAME		:TStringList::TextGet
Source00542=			:
Source00543=*MODULE		:StringList.cpp
Source00544=			:
Source00545=*FUNCTION	:テキスト
Source00546=			:
Source00547=*PROGRAMMED	:Y.Sasai
Source00548=*HISTORY	:
Source00549=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00550=*00 03.02.13 Y.Sasai Ver.0.90 
Source00551=*/
Source00552=CString TStringList::TextGet( void )
Source00553={
Source00554=	CString result = "";																		// 2003.02.13 Y.Sasai Ver.0.90 
Source00555=	int tempi;
Source00556=
Source00557=	for ( tempi = 0; tempi < Count; tempi++ ) {
Source00558=		result = result + Items[tempi] + "\n";													// 2003.02.13 Y.Sasai Ver.0.90 
Source00559=	}
Source00560=
Source00561=	return ( result );																			// 2003.02.13 Y.Sasai Ver.0.90 
Source00562=}
Source00563=
Source00564=
Source00565=/*=============================================================================
Source00566=*NAME		:TStringList::TextSet
Source00567=			:
Source00568=*MODULE		:StringList.cpp
Source00569=			:
Source00570=*FUNCTION	:テキスト
Source00571=			:
Source00572=*PROGRAMMED	:Y.Sasai
Source00573=*HISTORY	:
Source00574=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00575=*00 03.02.13 Y.Sasai Ver.0.90 
Source00576=*/
Source00577=void TStringList::TextSet( CString p1 )
Source00578={
Source00579=	CString txt;
Source00580=	int tempi = 0;
Source00581=	bool lstat = true;
Source00582=
Source00583=	Clear();																					// 2003.02.13 Y.Sasai Ver.0.90 全
Source00584=	while ( true ) {
Source00585=		lstat = LineGet( p1, txt );																// 2003.02.13 Y.Sasai Ver.0.90 １行
Source00586=		if ( lstat == false ) {																	// 2003.02.13 Y.Sasai Ver.0.90 おわりなら…
Source00587=			if ( txt != "" ) {																	// 2003.02.13 Y.Sasai Ver.0.90 空行でないなら…
Source00588=				Add( txt );																		// 2003.02.13 Y.Sasai Ver.0.90 
Source00589=			}
Source00590=			break;																				// 2003.02.13 Y.Sasai Ver.0.90 
Source00591=		}
Source00592=		Add( txt );																				// 2003.02.13 Y.Sasai Ver.0.90 
Source00593=	}
Source00594=}
Source00595=
Source00596=
Source00597=/*=============================================================================
Source00598=*NAME		:TStringList::LineGet
Source00599=			:
Source00600=*MODULE		:StringList.cpp
Source00601=			:
Source00602=*FUNCTION	:１行
Source00603=			:
Source00604=*PROCESS	:・１行取得処理です。
Source00605=			:
Source00606=*INPUT		:CString& source	:
Source00607=*INPUT		:CString& txt		:
Source00608=			:
Source00609=*RETURN		: true = 
Source00610=			:false = 
Source00611=			:
Source00612=*PROGRAMMED	:Y.Sasai
Source00613=*HISTORY	:
Source00614=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00615=*00 03.02.13 Y.Sasai Ver.0.90 
Source00616=*/
Source00617=bool TStringList::LineGet( CString& source, CString& txt )
Source00618={
Source00619=	const CString cr = "\n";																	// 2003.02.13 Y.Sasai Ver.0.90 改行
Source00620=	const int crpos = source.Find( cr );														// 2003.02.13 Y.Sasai Ver.0.90 改行
Source00621=	const int crlen = cr.GetLength();															// 2003.02.13 Y.Sasai Ver.0.90 改行
Source00622=	const bool result = ( crpos >= 0 );															// 2003.02.13 Y.Sasai Ver.0.90 改行文字があったらtrue
Source00623=
Source00624=	if ( result == true ) {																		// 2003.02.13 Y.Sasai Ver.0.90 改行文字があったら…
Source00625=		txt = source.Left( crpos );																// 2003.02.13 Y.Sasai Ver.0.90 
Source00626=		source = source.Mid( crpos + crlen );													// 2003.02.13 Y.Sasai Ver.0.90 改行文字以降
Source00627=	} else {																					// 2003.02.13 Y.Sasai Ver.0.90 改行文字がなかったら…
Source00628=		txt = source;																			// 2003.02.13 Y.Sasai Ver.0.90 そのままコピー
Source00629=		source = "";																			// 2003.02.13 Y.Sasai Ver.0.90 空行
Source00630=	}
Source00631=
Source00632=	return ( result );																			// 2003.02.13 Y.Sasai Ver.0.90 
Source00633=}
Source00634=
Source00635=
Source00636=// ===========================================
Source00637=//		関数定義終
Source00638=// ===========================================

[YSIniFiles.cpp]
Source00000=// ===========================================================
Source00001=//		YSIniFilesクラス
Source00002=//
Source00003=//				2003.02.10 Ver.1.0 
Source00004=// ===========================================================
Source00005=
Source00006=
Source00007=// ===========================================
Source00008=//		インクルード・ファイ
Source00009=// ===========================================
Source00010=#include <io.h>
Source00011=#include "stdafx.h"
Source00012=#include "YSIniFiles.h"
Source00013=#include "YSLib.h"
Source00014=
Source00015=
Source00016=// ===========================================
Source00017=//		マクロ定義
Source00018=// ===========================================
Source00019=
Source00020=
Source00021=// ===========================================
Source00022=//		数値定義
Source00023=// ===========================================
Source00024=
Source00025=
Source00026=// ===========================================
Source00027=//		構
Source00028=// ===========================================
Source00029=
Source00030=
Source00031=// ===========================================
Source00032=//		クラス
Source00033=// ===========================================
Source00034=
Source00035=
Source00036=// ===========================================
Source00037=//		変数定義
Source00038=// ===========================================
Source00039=
Source00040=
Source00041=// ===========================================
Source00042=//		関数定義
Source00043=// ===========================================
Source00044=
Source00045=
Source00046=/*=============================================================================
Source00047=*NAME		:TYSIniSection::Assign
Source00048=			:
Source00049=*MODULE		:YSIniFiles.cpp
Source00050=			:
Source00051=*FUNCTION	:内容コピー
Source00052=			:
Source00053=*PROCESS	:・内容コピー処理です。
Source00054=			:
Source00055=*INPUT		:const TStringList source	:コピーもとクラス
Source00056=			:
Source00057=*PROGRAMMED	:Y.Sasai
Source00058=*HISTORY	:
Source00059=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00060=*00 03.02.10 Y.Sasai Ver.0.90 
Source00061=*/
Source00062=void TYSIniSection::Assign( TYSIniSection* source )
Source00063={
Source00064=	FName = source->Name;																		// 2003.02.10 Y.Sasai Ver.0.90 セクション名コピー
Source00065=	TStringList::Assign( source );
Source00066=}
Source00067=
Source00068=
Source00069=/*=============================================================================
Source00070=*NAME		:TYSIniSection::Add
Source00071=			:
Source00072=*MODULE		:YSIniFiles.cpp
Source00073=			:
Source00074=*FUNCTION	:アイテムズ
Source00075=			:
Source00076=*PROCESS	:・アイテムズ追加処理です。
Source00077=			:
Source00078=*INPUT		:const CString txt		:
Source00079=			:
Source00080=*RETURN		:追加した要素位置
Source00081=			:
Source00082=*PROGRAMMED	:Y.Sasai
Source00083=*HISTORY	:
Source00084=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00085=*00 03.02.12 Y.Sasai Ver.0.90 
Source00086=*/
Source00087=int TYSIniSection::Add( const CString txt )
Source00088={
Source00089=	CString txt2 = txt;
Source00090=	int result;
Source00091=
Source00092=	txt2.TrimLeft();
Source00093=	txt2.TrimRight();
Source00094=	if ( txt2 != "" ) {																			// 2003.02.12 Y.Sasai Ver.0.90 文字列があるなら…
Source00095=		result = TStringList::Add( txt );														// 2003.02.12 Y.Sasai Ver.0.90 
Source00096=	} else {																					// 2003.02.12 Y.Sasai Ver.0.90 文字列がなかったら…
Source00097=		result = -1;																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00098=	}
Source00099=
Source00100=	return ( result );																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00101=}
Source00102=
Source00103=
Source00104=/*=============================================================================
Source00105=*NAME		:TYSIniSection::NameGet
Source00106=			:
Source00107=*MODULE		:YSIniFiles.cpp
Source00108=			:
Source00109=*FUNCTION	:セクシ
Source00110=			:
Source00111=*PROGRAMMED	:Y.Sasai
Source00112=*HISTORY	:
Source00113=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00114=*00 03.02.10 Y.Sasai Ver.0.90 
Source00115=*/
Source00116=CString TYSIniSection::NameGet( void )
Source00117={
Source00118=	return ( FName );
Source00119=}
Source00120=
Source00121=
Source00122=/*=============================================================================
Source00123=*NAME		:TStringList::NameSet
Source00124=			:
Source00125=*MODULE		:StringList.cpp
Source00126=			:
Source00127=*FUNCTION	:セクシ
Source00128=			:
Source00129=*PROGRAMMED	:Y.Sasai
Source00130=*HISTORY	:
Source00131=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00132=*00 03.02.10 Y.Sasai Ver.0.90 
Source00133=*/
Source00134=void TYSIniSection::NameSet( const CString txt )
Source00135={
Source00136=	FName = txt;
Source00137=}
Source00138=
Source00139=
Source00140=/*=============================================================================
Source00141=*NAME		:TYSIniFile::TYSIniFile
Source00142=			:
Source00143=*MODULE		:YSIniFiles.cpp
Source00144=			:
Source00145=*FUNCTION	:コンストラクタ
Source00146=			:
Source00147=*PROGRAMMED	:Y.Sasai
Source00148=*HISTORY	:
Source00149=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00150=*00 03.02.10 Y.Sasai Ver.0.90 
Source00151=*/
Source00152=TYSIniFile::TYSIniFile( const CString fname ) : CObList( 16 )
Source00153={
Source00154=	FFileName = fname;																			// 2003.02.10 Y.Sasai Ver.0.90 ファイ
Source00155=	Read();																						// 2003.02.10 Y.Sasai Ver.0.90 
Source00156=}
Source00157=
Source00158=
Source00159=/*=============================================================================
Source00160=*NAME		:TYSIniFile::TYSIniFile
Source00161=			:
Source00162=*MODULE		:YSIniFiles.cpp
Source00163=			:
Source00164=*FUNCTION	:デストラクタ
Source00165=			:
Source00166=*PROGRAMMED	:Y.Sasai
Source00167=*HISTORY	:
Source00168=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00169=*00 03.02.10 Y.Sasai Ver.0.90 
Source00170=*/
Source00171=TYSIniFile::~TYSIniFile( void )
Source00172={
Source00173=	Clear();																					// 2003.02.10 Y.Sasai Ver.0.90 全
Source00174=	CObList::~CObList();																		// 2003.02.12 Y.Sasai Ver.0.90 親クラス
Source00175=}
Source00176=
Source00177=
Source00178=/*=============================================================================
Source00179=*NAME		:TYSIniFile::Read
Source00180=			:
Source00181=*MODULE		:YSIniFiles.cpp
Source00182=			:
Source00183=*FUNCTION	:
Source00184=			:
Source00185=*PROCESS	:・Iniファイル読み込みです。
Source00186=			:
Source00187=*RETURN		: true = 正常終
Source00188=			:false = エラー終
Source00189=			:
Source00190=*PROGRAMMED	:Y.Sasai
Source00191=*HISTORY	:
Source00192=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00193=*00 03.02.10 Y.Sasai Ver.0.90 
Source00194=*/
Source00195=bool TYSIniFile::Read( void )
Source00196={
Source00197=	TStringList slist;																			// 2003.02.10 Y.Sasai Ver.0.90 文字列リスト
Source00198=	int tempi;
Source00199=	TYSIniSection* ysection;																	// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source00200=	CString sitem;
Source00201=
Source00202=	if ( FileName == "" ) {																		// 2003.02.10 Y.Sasai Ver.0.90 ファイル名未設定なら…
Source00203=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00204=	} else if ( FileExists( FileName ) == false ) {												// 2003.02.10 Y.Sasai Ver.0.90 そのファイルがなかったら…
Source00205=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00206=	}
Source00207=
Source00208=	ysection = NULL;																			// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source00209=	if ( slist.LoadFromFile( FileName ) == false ) {											// 2003.02.10 Y.Sasai Ver.0.90 ファイル読み込みエラーなら…
Source00210=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 エラー
Source00211=	}
Source00212=	for ( tempi = 0; tempi < slist.Count; tempi++ ) {
Source00213=		sitem = slist[tempi];
Source00214=		if ( sitem == "" ) {																	// 2003.02.10 Y.Sasai Ver.0.90 空行なら…
Source00215=			continue;																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00216=		}
Source00217=		if ( SectionCheck( sitem ) == true ) {													// 2003.02.10 Y.Sasai Ver.0.90 セクション名なら…
Source00218=			ysection = Add();																	// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00219=			ysection->Name = SectionNameGet( sitem );											// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00220=		} else if ( ysection != NULL ) {														// 2003.02.10 Y.Sasai Ver.0.90 セクション設定されているなら…
Source00221=			ysection->Add( sitem );																// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00222=		}
Source00223=	}
Source00224=
Source00225=	return ( true );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00226=}
Source00227=
Source00228=
Source00229=/*=============================================================================
Source00230=*NAME		:TYSIniFile::SectionCheck
Source00231=			:
Source00232=*MODULE		:YSIniFiles.cpp
Source00233=			:
Source00234=*FUNCTION	:セクションチェック
Source00235=			:
Source00236=*PROCESS	:・セクションチェック処理です。
Source00237=			:
Source00238=*INPUT		:const CString txt	:セクシ
Source00239=			:
Source00240=*RETURN		: true = 
Source00241=			:false = 
Source00242=			:
Source00243=*PROGRAMMED	:Y.Sasai
Source00244=*HISTORY	:
Source00245=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00246=*00 03.02.10 Y.Sasai Ver.0.90 
Source00247=*/
Source00248=bool TYSIniFile::SectionCheck( CString txt )
Source00249={
Source00250=	txt.TrimLeft();																				// 2003.02.10 Y.Sasai Ver.0.90 前
Source00251=	txt.TrimRight();
Source00252=	if ( txt == "" ) {																			// 2003.02.10 Y.Sasai Ver.0.90 空欄なら…
Source00253=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00254=	}
Source00255=
Source00256=	if ( txt[0] != '[' ) {																		// 2003.02.10 Y.Sasai Ver.0.90 セクション開始文字でないなら…
Source00257=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00258=	} else if ( txt.Find( ']' ) <= 0 ) {														// 2003.02.10 Y.Sasai Ver.0.90 セクション終了文字がないなら…
Source00259=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00260=	}
Source00261=
Source00262=	return ( true );																			// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00263=}
Source00264=
Source00265=
Source00266=/*=============================================================================
Source00267=*NAME		:TYSIniFile::SectionNameGet
Source00268=			:
Source00269=*MODULE		:YSIniFiles.cpp
Source00270=			:
Source00271=*FUNCTION	:セクシ
Source00272=			:
Source00273=*PROCESS	:・セクション名取得処理です。
Source00274=			:
Source00275=*INPUT		:CString txt	:
Source00276=			:
Source00277=*RETURN		:セクシ
Source00278=			:
Source00279=*PROGRAMMED	:Y.Sasai
Source00280=*HISTORY	:
Source00281=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00282=*00 03.02.10 Y.Sasai Ver.0.90 
Source00283=*/
Source00284=CString TYSIniFile::SectionNameGet( CString txt )
Source00285={
Source00286=	int kpos;
Source00287=	CString result;
Source00288=
Source00289=	txt.TrimLeft();																				// 2003.02.10 Y.Sasai Ver.0.90 前
Source00290=	txt.TrimRight();
Source00291=	kpos = txt.Find( ']' );																		// 2003.02.10 Y.Sasai Ver.0.90 かっこ文字位置
Source00292=	result = txt.Mid( 1, kpos - 1 );															// 2003.02.10 Y.Sasai Ver.0.90 
Source00293=
Source00294=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00295=}
Source00296=
Source00297=
Source00298=/*=============================================================================
Source00299=*NAME		:TYSIniFile::Write
Source00300=			:
Source00301=*MODULE		:YSIniFiles.cpp
Source00302=			:
Source00303=*FUNCTION	:
Source00304=			:
Source00305=*PROCESS	:・Iniファイル書き込み処理です。
Source00306=			:
Source00307=*RETURN		: true = 正常終
Source00308=			:false = エラー終
Source00309=			:
Source00310=*PROGRAMMED	:Y.Sasai
Source00311=*HISTORY	:
Source00312=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00313=*00 03.02.10 Y.Sasai Ver.0.90 
Source00314=*/
Source00315=bool TYSIniFile::Write( void )
Source00316={
Source00317=	TStringList slist;																			// 2003.02.10 Y.Sasai Ver.0.90 文字列リストクラス
Source00318=	int tempi;																					// 2003.02.10 Y.Sasai Ver.0.90 作業用
Source00319=
Source00320=	if ( FileName == "" ) {																		// 2003.02.10 Y.Sasai Ver.0.90 ファイル名未設定なら…
Source00321=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00322=	}
Source00323=	for ( tempi = 0; tempi < Count; tempi++ ) {
Source00324=		WriteSub( &slist, Items[tempi] );														// 2003.02.10 Y.Sasai Ver.0.90 
Source00325=		if ( tempi < ( Count - 1 ) ) {															// 2003.02.10 Y.Sasai Ver.0.90 最後でないなら…
Source00326=			slist.Add( "" );																	// 2003.02.10 Y.Sasai Ver.0.90 空行
Source00327=		}
Source00328=	}
Source00329=	slist.SaveToFile( FileName );																// 2003.02.10 Y.Sasai Ver.0.90 ファイ
Source00330=
Source00331=	return ( true );
Source00332=}
Source00333=
Source00334=
Source00335=/*=============================================================================
Source00336=*NAME		:TYSIniFile::WriteSub
Source00337=			:
Source00338=*MODULE		:YSIniFiles.cpp
Source00339=			:
Source00340=*FUNCTION	:書き込みサブ
Source00341=			:
Source00342=*PROCESS	:・書き込みサブ処理です。
Source00343=			:
Source00344=*INPUT		:TStringList slist			:文字列リストクラス
Source00345=*INPUT		:TYSIniSection ysection		:セクションクラス
Source00346=			:
Source00347=*PROGRAMMED	:Y.Sasai
Source00348=*HISTORY	:
Source00349=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00350=*00 03.02.10 Y.Sasai Ver.0.90 
Source00351=*/
Source00352=void TYSIniFile::WriteSub( TStringList* slist, TYSIniSection* ysection )
Source00353={
Source00354=	int tempi;
Source00355=
Source00356=	slist->Add( "[" + ysection->Name + "]" );													// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00357=	for ( tempi = 0; tempi < ysection->Count; tempi++ ) {
Source00358=		slist->Add( ysection->Items[tempi] );													// 2003.02.10 Y.Sasai Ver.0.90 
Source00359=	}
Source00360=}
Source00361=
Source00362=
Source00363=/*=============================================================================
Source00364=*NAME		:TYSIniFile::Add
Source00365=			:
Source00366=*MODULE		:YSIniFiles.cpp
Source00367=			:
Source00368=*FUNCTION	:
Source00369=			:
Source00370=*PROCESS	:・追加処理です。
Source00371=			:
Source00372=*RETURN		:追加クラス
Source00373=			:
Source00374=*PROGRAMMED	:Y.Sasai
Source00375=*HISTORY	:
Source00376=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00377=*00 03.02.10 Y.Sasai Ver.0.90 
Source00378=*/
Source00379=TYSIniSection* TYSIniFile::Add( void )
Source00380={
Source00381=	TYSIniSection* result = new TYSIniSection();												// 2003.02.10 Y.Sasai Ver.0.90 新規のセクションクラス
Source00382=
Source00383=	AddTail( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00384=
Source00385=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00386=}
Source00387=
Source00388=
Source00389=/*=============================================================================
Source00390=*NAME		:TYSIniFile::Delete
Source00391=			:
Source00392=*MODULE		:YSIniFiles.cpp
Source00393=			:
Source00394=*FUNCTION	:
Source00395=			:
Source00396=*PROCESS	:・削除処理です。
Source00397=			:
Source00398=*INPUT		:const int index	:インデックス
Source00399=			:
Source00400=*PROGRAMMED	:Y.Sasai
Source00401=*HISTORY	:
Source00402=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00403=*00 03.02.10 Y.Sasai Ver.0.90 
Source00404=*/
Source00405=void TYSIniFile::Delete( const int index )
Source00406={
Source00407=	TYSIniSection* ysection = (TYSIniSection*)GetAt( FindIndex( index ) );						// 2003.02.10 Y.Sasai Ver.0.90 iniセクションクラス
Source00408=
Source00409=	delete( ysection );																			// 2003.02.10 Y.Sasai Ver.0.90 破
Source00410=	RemoveAt( FindIndex( index ) );																// 2003.02.10 Y.Sasai Ver.0.90 
Source00411=}
Source00412=
Source00413=
Source00414=/*=============================================================================
Source00415=*NAME		:TYSIniFile::Assign
Source00416=			:
Source00417=*MODULE		:YSIniFiles.cpp
Source00418=			:
Source00419=*FUNCTION	:内容コピー
Source00420=			:
Source00421=*PROCESS	:・内容コピー処理です。
Source00422=			:
Source00423=*INPUT		:const TYSIniFile source	:コピーもとクラス
Source00424=			:
Source00425=*PROGRAMMED	:Y.Sasai
Source00426=*HISTORY	:
Source00427=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00428=*00 03.02.10 Y.Sasai Ver.0.90 
Source00429=*/
Source00430=void TYSIniFile::Assign( TYSIniFile* source )
Source00431={
Source00432=	int tempi;
Source00433=	TYSIniSection* ysection;
Source00434=
Source00435=	Clear();																					// 2003.02.10 Y.Sasai Ver.0.90 
Source00436=	for ( tempi = 0; tempi < source->Count; tempi++ ) {
Source00437=		ysection = Add();																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00438=		ysection->Assign( source->Items[tempi] );												// 2003.02.10 Y.Sasai Ver.0.90 内容コピー
Source00439=	}
Source00440=}
Source00441=
Source00442=
Source00443=/*=============================================================================
Source00444=*NAME		:TYSIniFile::Clear
Source00445=			:
Source00446=*MODULE		:YSIniFiles.cpp
Source00447=			:
Source00448=*FUNCTION	:全データ
Source00449=			:
Source00450=*PROCESS	:・全データ初期化処理です。
Source00451=			:
Source00452=*PROGRAMMED	:Y.Sasai
Source00453=*HISTORY	:
Source00454=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00455=*00 03.02.10 Y.Sasai Ver.0.90 
Source00456=*/
Source00457=void TYSIniFile::Clear( void )
Source00458={
Source00459=	int tempi;
Source00460=
Source00461=	for ( tempi = Count - 1; tempi >= 0; tempi-- ) {
Source00462=		Delete( tempi );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00463=	}
Source00464=}
Source00465=
Source00466=
Source00467=/*=============================================================================
Source00468=*NAME		:TYSIniFile::DeleteKey
Source00469=			:
Source00470=*MODULE		:YSIniFiles.cpp
Source00471=			:
Source00472=*FUNCTION	:キー
Source00473=			:
Source00474=*PROCESS	:・キー削除処理です。
Source00475=			:
Source00476=*INPUT		:const CString section	:セクシ
Source00477=*INPUT		:const CString iname	:Ident
Source00478=			:
Source00479=*PROGRAMMED	:Y.Sasai
Source00480=*HISTORY	:
Source00481=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00482=*00 03.02.10 Y.Sasai Ver.0.90 
Source00483=*/
Source00484=void TYSIniFile::DeleteKey( const CString section, const CString iname )
Source00485={
Source00486=	int spos = SectionIndex( section );															// 2003.02.10 Y.Sasai Ver.0.90 セクション位置
Source00487=
Source00488=	if ( spos >= 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00489=		Items[spos]->DeleteValue( iname );														// 2003.02.10 Y.Sasai Ver.0.90 
Source00490=	}
Source00491=}
Source00492=
Source00493=
Source00494=/*=============================================================================
Source00495=*NAME		:TYSIniFile::EraseSection
Source00496=			:
Source00497=*MODULE		:YSIniFiles.cpp
Source00498=			:
Source00499=*FUNCTION	:セクシ
Source00500=			:
Source00501=*PROCESS	:・セクション削除処理です。
Source00502=			:
Source00503=*INPUT		:const CString section		:セクシ
Source00504=			:
Source00505=*PROGRAMMED	:Y.Sasai
Source00506=*HISTORY	:
Source00507=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00508=*00 03.02.10 Y.Sasai Ver.0.90 
Source00509=*/
Source00510=void TYSIniFile::EraseSection( const CString section )
Source00511={
Source00512=	int spos = SectionIndex( section );															// 2003.02.10 Y.Sasai Ver.0.90 セクション位置
Source00513=
Source00514=	if ( spos >= 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00515=		RemoveAt( FindIndex( spos ) );															// 2003.02.10 Y.Sasai Ver.0.90 
Source00516=	}
Source00517=}
Source00518=
Source00519=
Source00520=/*=============================================================================
Source00521=*NAME		:TYSIniFile::ReadBool
Source00522=			:
Source00523=*MODULE		:YSIniFiles.cpp
Source00524=			:
Source00525=*FUNCTION	:bool値
Source00526=			:
Source00527=*PROCESS	:・bool値読み込み処理です。
Source00528=			:
Source00529=*INPUT		:const CString section	:セクシ
Source00530=*INPUT		:const CString iname	:Ident
Source00531=*INPUT		:const bool defvalue		:デフォルト値
Source00532=			:
Source00533=*RETURN		:値
Source00534=			:
Source00535=*PROGRAMMED	:Y.Sasai
Source00536=*HISTORY	:
Source00537=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00538=*00 03.02.10 Y.Sasai Ver.0.90 
Source00539=*/
Source00540=bool TYSIniFile::ReadBool( const CString section, const CString iname, const bool defvalue )
Source00541={
Source00542=	bool result = ( ReadInteger( section, iname, (int)defvalue ) != 0 );						// 2003.02.10 Y.Sasai Ver.0.90 
Source00543=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00544=}
Source00545=
Source00546=
Source00547=/*=============================================================================
Source00548=*NAME		:TYSIniFile::ReadFloat
Source00549=			:
Source00550=*MODULE		:YSIniFiles.cpp
Source00551=			:
Source00552=*FUNCTION	:double値
Source00553=			:
Source00554=*PROCESS	:・double値読み込み処理です。
Source00555=			:
Source00556=*INPUT		:const CString section	:セクシ
Source00557=*INPUT		:const CString iname	:Ident
Source00558=*INPUT		:const double defvalue	:デフォルト値
Source00559=			:
Source00560=*RETURN		:値
Source00561=			:
Source00562=*PROGRAMMED	:Y.Sasai
Source00563=*HISTORY	:
Source00564=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00565=*00 03.02.10 Y.Sasai Ver.0.90 
Source00566=*/
Source00567=double TYSIniFile::ReadFloat( const CString section, const CString iname, const double defvalue )
Source00568={
Source00569=	double result = StrToFloat( ReadString( section, iname, FloatToStr( defvalue ) ) );
Source00570=	return ( result );
Source00571=}
Source00572=
Source00573=
Source00574=/*=============================================================================
Source00575=*NAME		:TYSIniFile::ReadInteger
Source00576=			:
Source00577=*MODULE		:YSIniFiles.cpp
Source00578=			:
Source00579=*FUNCTION	:int値
Source00580=			:
Source00581=*PROCESS	:・int値読み込み処理です。
Source00582=			:
Source00583=*INPUT		:const CString section	:セクシ
Source00584=*INPUT		:const CString iname	:Ident
Source00585=*INPUT		:const int defvalue		:デフォルト値
Source00586=			:
Source00587=*RETURN		:値
Source00588=			:
Source00589=*PROGRAMMED	:Y.Sasai
Source00590=*HISTORY	:
Source00591=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00592=*00 03.02.10 Y.Sasai Ver.0.90 
Source00593=*/
Source00594=int TYSIniFile::ReadInteger( const CString section, const CString iname, const int defvalue )
Source00595={
Source00596=	int result = StrToInt( ReadString( section, iname, IntToStr( defvalue ) ) );
Source00597=	return ( result );
Source00598=}
Source00599=
Source00600=
Source00601=/*=============================================================================
Source00602=*NAME		:TYSIniFile::ReadPoint
Source00603=			:
Source00604=*MODULE		:YSIniFiles.cpp
Source00605=			:
Source00606=*FUNCTION	:座標構
Source00607=			:
Source00608=*PROCESS	:・座標構造体読み込み処理です。
Source00609=			:
Source00610=*INPUT		:const CString section	:セクシ
Source00611=*INPUT		:const CString iname	:Ident
Source00612=*INPUT		:const CPoint* point	:座標構造体ポインタ
Source00613=			:
Source00614=*RETURN		:値
Source00615=			:
Source00616=*PROGRAMMED	:Y.Sasai
Source00617=*HISTORY	:
Source00618=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00619=*00 03.02.12 Y.Sasai Ver.0.90 
Source00620=*/
Source00621=CPoint TYSIniFile::ReadPoint( const CString section, const CString iname, const CPoint* point )
Source00622={
Source00623=	CPoint defpoint;																			// 2003.02.12 Y.Sasai Ver.0.90 初期値
Source00624=	CPoint result;																				// 2003.02.12 Y.Sasai Ver.0.90 終了値
Source00625=
Source00626=	if ( point != NULL ) {																		// 2003.02.12 Y.Sasai Ver.0.90 デフォルト設定があるなら…
Source00627=		defpoint = *point;																		// 2003.02.12 Y.Sasai Ver.0.90 座標
Source00628=	} else {																					// 2003.02.12 Y.Sasai Ver.0.90 デフォルトがないなら…
Source00629=		defpoint.x = 0;																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00630=		defpoint.y = 0;																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00631=	};
Source00632=	result.x = ReadInteger( section, iname + XIdent, defpoint.x );								// 2003.02.12 Y.Sasai Ver.0.90 ｘ座標
Source00633=	result.y = ReadInteger( section, iname + YIdent, defpoint.y );								// 2003.02.12 Y.Sasai Ver.0.90 ｙ座標
Source00634=
Source00635=	return ( result );																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00636=}
Source00637=
Source00638=
Source00639=/*=============================================================================
Source00640=*NAME		:TYSIniFile::ReadRect
Source00641=			:
Source00642=*MODULE		:YSIniFiles.cpp
Source00643=			:
Source00644=*FUNCTION	:四角形構
Source00645=			:
Source00646=*PROCESS	:・四角形構造体読み込み処理です。
Source00647=			:
Source00648=*INPUT		:const CString section	:セクシ
Source00649=*INPUT		:const CString iname	:Ident
Source00650=*INPUT		:const CRect* rect		:四角形構造体ポインタ
Source00651=			:
Source00652=*RETURN		:値
Source00653=			:
Source00654=*PROGRAMMED	:Y.Sasai
Source00655=*HISTORY	:
Source00656=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00657=*00 03.02.12 Y.Sasai Ver.0.90 
Source00658=*/
Source00659=CRect TYSIniFile::ReadRect( const CString section, const CString iname, const CRect* rect )
Source00660={
Source00661=	CRect defrect;																				// 2003.02.12 Y.Sasai Ver.0.90 初期値
Source00662=	CRect result;																				// 2003.02.12 Y.Sasai Ver.0.90 終了値
Source00663=
Source00664=	if ( rect != NULL ) {																		// 2003.02.12 Y.Sasai Ver.0.90 デフォルト設定があるなら…
Source00665=		defrect = *rect;																		// 2003.02.12 Y.Sasai Ver.0.90 座標
Source00666=	} else {																					// 2003.02.12 Y.Sasai Ver.0.90 デフォルトがないなら…
Source00667=		defrect.left = 0;																		// 2003.02.12 Y.Sasai Ver.0.90 
Source00668=		defrect.top = 0;																		// 2003.02.12 Y.Sasai Ver.0.90 
Source00669=		defrect.right = 0;																		// 2003.02.12 Y.Sasai Ver.0.90 
Source00670=		defrect.bottom = 0;																		// 2003.02.12 Y.Sasai Ver.0.90 
Source00671=	}
Source00672=
Source00673=	result.left = ReadInteger( section, iname + LeftIdent, defrect.left );						// 2003.02.12 Y.Sasai Ver.0.90 左座標
Source00674=	result.top = ReadInteger( section, iname + TopIdent, defrect.top );							// 2003.02.12 Y.Sasai Ver.0.90 上座標
Source00675=	result.right = ReadInteger( section, iname + RightIdent, defrect.right );					// 2003.02.12 Y.Sasai Ver.0.90 右座標
Source00676=	result.bottom = ReadInteger( section, iname + BottomIdent, defrect.bottom );				// 2003.02.12 Y.Sasai Ver.0.90 下座標
Source00677=	result.NormalizeRect();																		// 2003.02.12 Y.Sasai Ver.0.90 四角形の正規
Source00678=
Source00679=	return ( result );																			// 2003.02.12 Y.Sasai Ver.0.90 
Source00680=}
Source00681=
Source00682=
Source00683=/*=============================================================================
Source00684=*NAME		:TYSIniFile::ReadString
Source00685=			:
Source00686=*MODULE		:YSIniFiles.cpp
Source00687=			:
Source00688=*FUNCTION	:文字列値
Source00689=			:
Source00690=*PROCESS	:・文字列値読み込み処理です。
Source00691=			:
Source00692=*INPUT		:const CString section	:セクシ
Source00693=*INPUT		:const CString iname	:Ident
Source00694=*INPUT		:const CString defvalue	:デフォルト値
Source00695=			:
Source00696=*RETURN		:値
Source00697=			:
Source00698=*PROGRAMMED	:Y.Sasai
Source00699=*HISTORY	:
Source00700=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00701=*00 03.02.10 Y.Sasai Ver.0.90 
Source00702=*/
Source00703=CString TYSIniFile::ReadString( const CString section, const CString iname, const CString defvalue )
Source00704={
Source00705=	CString result = defvalue;																	// 2003.02.10 Y.Sasai Ver.0.90 終了値
Source00706=	int spos;
Source00707=	TYSIniSection* ysection;																	// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source00708=
Source00709=	spos = SectionIndex( section );																// 2003.02.10 Y.Sasai Ver.0.90 セクション位置
Source00710=	if ( spos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00711=		ysection = Add();																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00712=		ysection->Name = section;																// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source00713=		ysection->Value[iname] = defvalue;														// 2003.02.10 Y.Sasai Ver.0.90 
Source00714=	} else {																					// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00715=		ysection = Items[spos];																	// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source00716=		if ( ysection->IdentExists( iname ) == true ) {											// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source00717=			result = ysection->Value[iname];													// 2003.02.10 Y.Sasai Ver.0.90 
Source00718=		} else {																				// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00719=			ysection->Value[iname] = defvalue;													// 2003.02.10 Y.Sasai Ver.0.90 初期値
Source00720=		}
Source00721=	}
Source00722=
Source00723=	return ( result );
Source00724=}
Source00725=
Source00726=
Source00727=/*=============================================================================
Source00728=*NAME		:TYSIniFile::ReadStringList
Source00729=			:
Source00730=*MODULE		:YSIniFiles.cpp
Source00731=			:
Source00732=*FUNCTION	:文字列リスト
Source00733=			:
Source00734=*PROCESS	:・文字列リスト読み込み処理です。
Source00735=			:
Source00736=*INPUT		:const CString section	:セクシ
Source00737=*INPUT		:const CString iname	:Ident
Source00738=*INPUT		:TStringList& slist		:設定クラス
Source00739=			:
Source00740=*RETURN		:読み込み行
Source00741=			:
Source00742=*PROGRAMMED	:Y.Sasai
Source00743=*HISTORY	:
Source00744=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00745=*00 03.02.13 Y.Sasai Ver.0.90 
Source00746=*/
Source00747=int TYSIniFile::ReadStringList( const CString section, const CString iname, TStringList& slist )
Source00748={
Source00749=	int result = 0;																				// 2003.02.13 Y.Sasai Ver.0.90 
Source00750=	CString ident;
Source00751=	CString txt;
Source00752=
Source00753=	slist.Clear();																				// 2003.02.13 Y.Sasai Ver.0.90 全
Source00754=	while ( true ) {
Source00755=		ident = iname + Number[result];															// 2003.02.13 Y.Sasai Ver.0.90 Ident
Source00756=		if ( ValueExists( section, ident ) == false ) {											// 2003.02.13 Y.Sasai Ver.0.90 Ident名がなかったら…
Source00757=			break;																				// 2003.02.13 Y.Sasai Ver.0.90 
Source00758=		}
Source00759=		txt = ReadString( section, ident, "" );													// 2003.02.13 Y.Sasai Ver.0.90 
Source00760=		slist.Add( txt );																		// 2003.02.13 Y.Sasai Ver.0.90 
Source00761=		result++;																				// 2003.02.13 Y.Sasai Ver.0.00 加算
Source00762=	}
Source00763=
Source00764=	return ( result );																			// 2003.02.13 Y.Sasai Ver.0.90 
Source00765=}
Source00766=
Source00767=
Source00768=/*=============================================================================
Source00769=*NAME		:TYSIniFile::SectionIndex
Source00770=			:
Source00771=*MODULE		:YSIniFiles.cpp
Source00772=			:
Source00773=*FUNCTION	:セクション位置
Source00774=			:
Source00775=*PROCESS	:・セクション位置取得処理です。
Source00776=			:
Source00777=*INPUT		:const CString section	:セクシ
Source00778=			:
Source00779=*RETURN		:位置
Source00780=			:
Source00781=*PROGRAMMED	:Y.Sasai
Source00782=*HISTORY	:
Source00783=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00784=*00 03.02.10 Y.Sasai Ver.0.90 
Source00785=*/
Source00786=int TYSIniFile::SectionIndex( const CString section )
Source00787={
Source00788=	int tempi;
Source00789=
Source00790=	for ( tempi = 0; tempi < Count; tempi++ ) {
Source00791=		if ( section.CompareNoCase( Items[tempi]->Name ) == 0 ) {								// 2003.02.10 Y.Sasai Ver.0.90 みつかったら…
Source00792=			return ( tempi );																	// 2003.02.10 Y.Sasai Ver.0.90 
Source00793=		}
Source00794=	}
Source00795=
Source00796=	return ( -1 );																				// 2003.02.10 Y.Sasai Ver.0.90 
Source00797=}
Source00798=
Source00799=
Source00800=/*=============================================================================
Source00801=*NAME		:TYSIniFile::SectionExists
Source00802=			:
Source00803=*MODULE		:YSIniFiles.cpp
Source00804=			:
Source00805=*FUNCTION	:セクション存在チェック
Source00806=			:
Source00807=*PROCESS	:・セクション存在チェック処理です。
Source00808=			:
Source00809=*INPUT		:const CString section	:セクシ
Source00810=			:
Source00811=*RETURN		: true = 
Source00812=			:false = 
Source00813=			:
Source00814=*PROGRAMMED	:Y.Sasai
Source00815=*HISTORY	:
Source00816=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00817=*00 03.02.10 Y.Sasai Ver.0.90 
Source00818=*/
Source00819=bool TYSIniFile::SectionExists( const CString section )
Source00820={
Source00821=	bool result = ( SectionIndex( section ) >= 0 );												// 2003.02.10 Y.Sasai Ver.0.90 インデックス
Source00822=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00823=}
Source00824=
Source00825=
Source00826=/*=============================================================================
Source00827=*NAME		:TYSIniFile::UpdateFile
Source00828=			:
Source00829=*MODULE		:YSIniFiles.cpp
Source00830=			:
Source00831=*FUNCTION	:データ
Source00832=			:
Source00833=*PROCESS	:・データ書き込み処理です。
Source00834=			:
Source00835=*PROGRAMMED	:Y.Sasai
Source00836=*HISTORY	:
Source00837=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00838=*00 03.02.10 Y.Sasai Ver.0.90 
Source00839=*/
Source00840=bool TYSIniFile::UpdateFile( void )
Source00841={
Source00842=	bool result = Write();																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00843=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00844=}
Source00845=
Source00846=
Source00847=/*=============================================================================
Source00848=*NAME		:TYSIniFile::ValueExists
Source00849=			:
Source00850=*MODULE		:YSIniFiles.cpp
Source00851=			:
Source00852=*FUNCTION	:キー存在チェック関数です。
Source00853=			:
Source00854=*PROCESS	:・キー存在チェックです。
Source00855=			:
Source00856=*INPUT		:const CString section	:セクシ
Source00857=*INPUT		:const CString iname	:Ident
Source00858=			:
Source00859=*RETURN		: true = 
Source00860=			:false = 
Source00861=			:
Source00862=*PROGRAMMED	:Y.Sasai
Source00863=*HISTORY	:
Source00864=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00865=*00 03.02.10 Y.Sasai Ver.0.90 
Source00866=*/
Source00867=bool TYSIniFile::ValueExists( const CString section, const CString iname )
Source00868={
Source00869=	int spos = SectionIndex( section );															// 2003.02.10 Y.Sasai Ver.0.90 セクション位置
Source00870=
Source00871=	if ( spos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00872=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00873=	} else if ( Items[spos]->IdentExists( iname ) == false ) {									// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source00874=		return ( false );																		// 2003.02.10 Y.Sasai Ver.0.90 
Source00875=	}
Source00876=
Source00877=	return ( true );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source00878=}
Source00879=
Source00880=
Source00881=/*=============================================================================
Source00882=*NAME		:TYSIniFile::WriteBool
Source00883=			:
Source00884=*MODULE		:YSIniFiles.cpp
Source00885=			:
Source00886=*FUNCTION	:bool値
Source00887=			:
Source00888=*PROCESS	:・bool値書き込み処理です。
Source00889=			:
Source00890=*INPUT		:const CString section	:セクシ
Source00891=*INPUT		:const CString iname	:Ident
Source00892=*INPUT		:const bool ival		:値
Source00893=			:
Source00894=*PROGRAMMED	:Y.Sasai
Source00895=*HISTORY	:
Source00896=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00897=*00 03.02.10 Y.Sasai Ver.0.90 
Source00898=*/
Source00899=void TYSIniFile::WriteBool( const CString section, const CString iname, const bool ival )
Source00900={
Source00901=	WriteInteger( section, iname, (int)ival );
Source00902=}
Source00903=
Source00904=
Source00905=/*=============================================================================
Source00906=*NAME		:TYSIniFile::WriteFloat
Source00907=			:
Source00908=*MODULE		:YSIniFiles.cpp
Source00909=			:
Source00910=*FUNCTION	:double値
Source00911=			:
Source00912=*PROCESS	:・double値書き込み処理です。
Source00913=			:
Source00914=*INPUT		:const CString section	:セクシ
Source00915=*INPUT		:const CString iname	:Ident
Source00916=*INPUT		:const double ival		:値
Source00917=			:
Source00918=*PROGRAMMED	:Y.Sasai
Source00919=*HISTORY	:
Source00920=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00921=*00 03.02.10 Y.Sasai Ver.0.90 
Source00922=*/
Source00923=void TYSIniFile::WriteFloat( const CString section, const CString iname, const double ival )
Source00924={
Source00925=	WriteString( section, iname, FloatToStr( ival ) );
Source00926=}
Source00927=
Source00928=
Source00929=/*=============================================================================
Source00930=*NAME		:TYSIniFile::WriteInteger
Source00931=			:
Source00932=*MODULE		:YSIniFiles.cpp
Source00933=			:
Source00934=*FUNCTION	:int値
Source00935=			:
Source00936=*PROCESS	:・int値書き込み処理です。
Source00937=			:
Source00938=*INPUT		:const CString section	:セクシ
Source00939=*INPUT		:const CString iname	:Ident
Source00940=*INPUT		:const int ival			:値
Source00941=			:
Source00942=*PROGRAMMED	:Y.Sasai
Source00943=*HISTORY	:
Source00944=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00945=*00 03.02.10 Y.Sasai Ver.0.90 
Source00946=*/
Source00947=void TYSIniFile::WriteInteger( const CString section, const CString iname, const int ival )
Source00948={
Source00949=	WriteString( section, iname, IntToStr( ival ) );
Source00950=}
Source00951=
Source00952=
Source00953=/*=============================================================================
Source00954=*NAME		:TYSIniFile::WritePoint
Source00955=			:
Source00956=*MODULE		:YSIniFiles.cpp
Source00957=			:
Source00958=*FUNCTION	:座標構
Source00959=			:
Source00960=*PROCESS	:・座標構造体書き込み処理です。
Source00961=			:
Source00962=*INPUT		:const CString section		:セクシ
Source00963=*INPUT		:const CString iname		:Ident
Source00964=*INPUT		:const CPoint& point		:座標構
Source00965=			:
Source00966=*PROGRAMMED	:Y.Sasai
Source00967=*HISTORY	:
Source00968=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00969=*00 03.02.12 Y.Sasai Ver.0.90 
Source00970=*/
Source00971=void TYSIniFile::WritePoint( const CString section, const CString iname, const CPoint& point )
Source00972={
Source00973=	WriteInteger( section, iname + XIdent, point.x );											// 2003.02.12 Y.Sasai Ver.0.90 ｘ座標
Source00974=	WriteInteger( section, iname + YIdent, point.y );											// 2003.02.12 Y.Sasai Ver.0.90 ｙ座標
Source00975=}
Source00976=
Source00977=
Source00978=/*=============================================================================
Source00979=*NAME		:TYSIniFile::WriteRect
Source00980=			:
Source00981=*MODULE		:YSIniFiles.cpp
Source00982=			:
Source00983=*FUNCTION	:四角形構
Source00984=			:
Source00985=*PROCESS	:・四角形構造体書き込み処理です。
Source00986=			:
Source00987=*INPUT		:const CString section	:セクシ
Source00988=*INPUT		:const CString iname	:Ident
Source00989=*INPUT		:const CRect& rect		:座標構
Source00990=			:
Source00991=*PROGRAMMED	:Y.Sasai
Source00992=*HISTORY	:
Source00993=*ID -- DATE ------- NOTE ------------------------------------------------------
Source00994=*00 03.02.12 Y.Sasai Ver.0.90 
Source00995=*/
Source00996=void TYSIniFile::WriteRect( const CString section, const CString iname, const CRect& rect )
Source00997={
Source00998=	CRect rc = rect;																			// 2003.02.12 Y.Sasai Ver.0.90 四角形
Source00999=
Source01000=	rc.NormalizeRect();																			// 2003.02.12 Y.Sasai Ver.0.90 四角形の正規
Source01001=	WriteInteger( section, iname + LeftIdent, rc.left );										// 2003.02.12 Y.Sasai Ver.0.90 左座標
Source01002=	WriteInteger( section, iname + TopIdent, rc.top );											// 2003.02.12 Y.Sasai Ver.0.90 上座標
Source01003=	WriteInteger( section, iname + RightIdent, rc.right );										// 2003.02.12 Y.Sasai Ver.0.90 右座標
Source01004=	WriteInteger( section, iname + BottomIdent, rc.bottom );									// 2003.02.12 Y.Sasai Ver.0.90 下座標
Source01005=}
Source01006=
Source01007=
Source01008=/*=============================================================================
Source01009=*NAME		:TYSIniFile::WriteString
Source01010=			:
Source01011=*MODULE		:YSIniFiles.cpp
Source01012=			:
Source01013=*FUNCTION	:文字列値
Source01014=			:
Source01015=*PROCESS	:・文字列値書き込み処理です。
Source01016=			:
Source01017=*INPUT		:const CString section	:セクシ
Source01018=*INPUT		:const CString iname	:Ident
Source01019=*INPUT		:const CString ival		:値
Source01020=			:
Source01021=*PROGRAMMED	:Y.Sasai
Source01022=*HISTORY	:
Source01023=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01024=*00 03.02.10 Y.Sasai Ver.0.90 
Source01025=*/
Source01026=void TYSIniFile::WriteString( const CString section, const CString iname, const CString ival )
Source01027={
Source01028=	int spos = SectionIndex( section );															// 2003.02.10 Y.Sasai Ver.0.90 セクション位置
Source01029=	TYSIniSection* ysection;																	// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source01030=
Source01031=	if ( spos < 0 ) {																			// 2003.02.10 Y.Sasai Ver.0.90 なかったら…
Source01032=		ysection = Add();																		// 2003.02.10 Y.Sasai Ver.0.90 
Source01033=		ysection->Name = section;																// 2003.02.10 Y.Sasai Ver.0.90 セクシ
Source01034=		ysection->Value[iname] = ival;															// 2003.02.10 Y.Sasai Ver.0.90 
Source01035=	} else {																					// 2003.02.10 Y.Sasai Ver.0.90 あったら…
Source01036=		ysection = Items[spos];																	// 2003.02.10 Y.Sasai Ver.0.90 セクションクラス
Source01037=		ysection->Value[iname] = ival;															// 2003.02.10 Y.Sasai Ver.0.90 
Source01038=	}
Source01039=}
Source01040=
Source01041=
Source01042=/*=============================================================================
Source01043=*NAME		:TYSIniFile::WriteStringList
Source01044=			:
Source01045=*MODULE		:YSIniFiles.cpp
Source01046=			:
Source01047=*FUNCTION	:文字列リスト
Source01048=			:
Source01049=*PROCESS	:・文字列リストの書き込みです。
Source01050=			:
Source01051=*INPUT		:const CString section		:セクシ
Source01052=*INPUT		:const CString iname		:Ident
Source01053=*INPUT		:const TStringList& slist	:内容
Source01054=			:
Source01055=*PROGRAMMED	:Y.Sasai
Source01056=*HISTORY	:
Source01057=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01058=*00 03.02.13 Y.Sasai Ver.0.90 
Source01059=*/
Source01060=void TYSIniFile::WriteStringList( const CString section, const CString iname, TStringList& slist )
Source01061={
Source01062=	CString ident;
Source01063=	int tempi;
Source01064=
Source01065=	for ( tempi = 0; true; tempi++ ) {
Source01066=		ident = iname + Number[tempi];															// 2003.02.13 Y.Sasai Ver.0.00 Ident
Source01067=		if ( tempi < slist.Count ) {															// 2003.02.13 Y.Sasai Ver.0.00 文字列リスト行数内なら…
Source01068=			WriteString( section, iname + Number[tempi], slist[tempi] );						// 2003.02.13 Y.Sasai Ver.0.90 
Source01069=		} else {																				// 2003.02.13 Y.Sasai Ver.0.00 行数を超えたら…
Source01070=			if ( ValueExists( section, ident ) == false ) {										// 2003.02.13 Y.Sasai Ver.0.90 Ident名がなかったら…
Source01071=				break;																			// 2003.02.13 Y.Sasai Ver.0.00 
Source01072=			}
Source01073=			DeleteKey( section, ident );														// 2003.02.13 Y.Sasai Ver.0.00 
Source01074=		}
Source01075=	}
Source01076=}
Source01077=
Source01078=
Source01079=/*=============================================================================
Source01080=*NAME		:TYSIniFile::NumberGet
Source01081=			:
Source01082=*MODULE		:YSIniFiles.cpp
Source01083=			:
Source01084=*FUNCTION	:数値
Source01085=			:
Source01086=*PROGRAMMED	:Y.Sasai
Source01087=*HISTORY	:
Source01088=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01089=*00 03.02.13 Y.Sasai Ver.0.90 
Source01090=*/
Source01091=CString TYSIniFile::NumberGet( const int a1 )
Source01092={
Source01093=	CString result;
Source01094=	char nbuf[16];
Source01095=
Source01096=	sprintf( nbuf, "%05d", a1 );																// 2003.02.13 Y.Sasai Ver.0.90 
Source01097=	result = nbuf;																				// 2003.02.13 Y.Sasai Ver.0.90 内容
Source01098=
Source01099=	return ( result );																			// 2003.02.13 Y.Sasai Ver.0.90 
Source01100=}
Source01101=
Source01102=
Source01103=/*=============================================================================
Source01104=*NAME		:TYSIniFile::FileNameGet
Source01105=			:
Source01106=*MODULE		:YSIniFiles.cpp
Source01107=			:
Source01108=*FUNCTION	:ファイ
Source01109=			:
Source01110=*PROGRAMMED	:Y.Sasai
Source01111=*HISTORY	:
Source01112=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01113=*00 03.02.10 Y.Sasai Ver.0.90 
Source01114=*/
Source01115=CString TYSIniFile::FileNameGet( void )
Source01116={
Source01117=	return ( FFileName );
Source01118=}
Source01119=
Source01120=
Source01121=/*=============================================================================
Source01122=*NAME		:TYSIniFile::FileNameSet
Source01123=			:
Source01124=*MODULE		:YSIniFiles.cpp
Source01125=			:
Source01126=*FUNCTION	:ファイ
Source01127=			:
Source01128=*PROGRAMMED	:Y.Sasai
Source01129=*HISTORY	:
Source01130=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01131=*00 03.02.10 Y.Sasai Ver.0.90 
Source01132=*/
Source01133=void TYSIniFile::FileNameSet( const CString p1 )
Source01134={
Source01135=	FFileName = p1;																				// 2003.02.10 Y.Sasai Ver.0.90 
Source01136=}
Source01137=
Source01138=
Source01139=/*=============================================================================
Source01140=*NAME		:TYSIniFile::ItemsGet
Source01141=			:
Source01142=*MODULE		:YSIniFiles.cpp
Source01143=			:
Source01144=*FUNCTION	:アイテムズ
Source01145=			:
Source01146=*PROGRAMMED	:Y.Sasai
Source01147=*HISTORY	:
Source01148=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01149=*00 03.02.10 Y.Sasai Ver.0.90 
Source01150=*/
Source01151=TYSIniSection* TYSIniFile::ItemsGet( const int a1 )
Source01152={
Source01153=	TYSIniSection* result = (TYSIniSection*)GetAt( FindIndex( a1 ) );							// 2003.02.10 Y.Sasai Ver.0.90 
Source01154=	return ( result );																			// 2003.02.10 Y.Sasai Ver.0.90 
Source01155=}
Source01156=
Source01157=
Source01158=/*=============================================================================
Source01159=*NAME		:TYSIniFile::ItemsSet
Source01160=			:
Source01161=*MODULE		:YSIniFiles.cpp
Source01162=			:
Source01163=*FUNCTION	:アイテムズ
Source01164=			:
Source01165=*PROGRAMMED	:Y.Sasai
Source01166=*HISTORY	:
Source01167=*ID -- DATE ------- NOTE ------------------------------------------------------
Source01168=*00 03.02.10 Y.Sasai Ver.0.90 
Source01169=*/
Source01170=void TYSIniFile::ItemsSet( const int a1, TYSIniSection* p1 )
Source01171={
Source01172=	TYSIniSection* ysection = (TYSIniSection*)GetAt( FindIndex( a1 ) );							// 2003.02.10 Y.Sasai Ver.0.90 
Source01173=
Source01174=	ysection->Assign( p1 );																		// 2003.02.10 Y.Sasai Ver.0.90 内容コピー
Source01175=}
Source01176=
Source01177=
Source01178=// ===========================================
Source01179=//		関数定義終
Source01180=// ===========================================
